unit UEtatJourReg;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, Grids, DBGrids, StdCtrls, Mask, DBCtrls, OButton, ExtCtrls;

type
  TFEtatJourReg = class(TForm)
    Panel3: TPanel;
    LbDateJ: TLabel;
    Panel4: TPanel;
    OfficeButton2: TOfficeButton;
    Label3: TLabel;
    DBEdit2: TDBEdit;
    DBGrid1: TDBGrid;
    procedure FormShow(Sender: TObject);
    procedure OfficeButton2Click(Sender: TObject);
  private
    { Déclarations privées }
  public
    { Déclarations publiques }
  end;

var
  FEtatJourReg: TFEtatJourReg;

implementation

uses UDmPressing, UQrEtatJourReg;

{$R *.dfm}

procedure TFEtatJourReg.FormShow(Sender: TObject);
begin
LbDateJ.Caption:='De la journée du '+FormatDateTime('dddddd',(date));
with DmPressing
do begin
QReglementJournalier.Close;
   QReglementJournalier.ParamByName('d1').AsDateTime:= date();
      QReglementJournalier.ParamByName('d2').AsDateTime:= date();
   QReglementJournalier.Open;

   QReglementJournaliertotal.Close;
   QReglementJournaliertotal.ParamByName('d1').AsDateTime:= date();
      QReglementJournaliertotal.ParamByName('d2').AsDateTime:= date();
   QReglementJournaliertotal.Open;
end;
end;

procedure TFEtatJourReg.OfficeButton2Click(Sender: TObject);
begin
QrEtatJourReg.Preview;
end;

end.
